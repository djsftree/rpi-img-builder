#!/bin/bash

# variables
CPUT=$(/opt/vc/bin/vcgencmd measure_temp | egrep -o '[0-9]*\.[0-9]*')
CPU=`lscpu | grep "Model name" | sed -n 1p | sed 's/Model name://g' | sed -r '1s/\s+//g'`
CPUM=`lscpu | grep "CPU max MHz" | sed -n 1p | sed 's/CPU max MHz://g' | sed -r '1s/\s+//g' | sed 's/.0000//g'`
COL="\033[1m"
FIN="\033[0m"
NETWORK=$(ip -o -4 -br a | grep -v '^lo'| sed 's/^/ /' | sed 's/\/..//' | sed -r '1s/\s+/ /g' | sed -r '2s/\s+/ /g')
ETH0=`echo -e ${COL}Wired:${FIN}`
WLAN0=`echo -e ${COL}Wireless:${FIN}`
USB0=`echo -e ${COL}Tether:${FIN}`

# function
mem_hwinfo(){
meminfo=$(awk '$3=="kB"{if ($2>1024^2){$2=$2/1024^2;$3="GB";} else if ($2>1024){$2=$2/1024;$3="MB";}} 1' /proc/meminfo)
echo "$meminfo" | column -t;
unset meminfo;
}

# display
echo -e "${COL}== DISK${FIN}"
df -h | egrep '(Filesystem)|(/dev/mmc)|(/dev/root)|(/dev/sd)|(/dev/nvme)'
echo ""
echo -e "${COL}== NETWORK${FIN}"
echo -e "${COL}Hostname:${FIN}    $(hostname)"
echo -e "$NETWORK" | sed "s/^[ \t]*//" | sed "s/eth0/$ETH0       eth0/g" | sed "s/wlan0/$WLAN0    wlan0/g" | sed "s/usb0/$USB0      usb0/g"
echo ""
echo -e "${COL}== SYSTEM${FIN}"
if [[ -f "/sys/devices/system/cpu/present" ]]; then
	echo -en "${COL}Processor${FIN}:  " $CPU; echo -en " @ $CPUM"; echo -e "MHz $CPUT°C";
else
	echo -e "${COL}Temperature:${FIN}" $CPUT°C;
	echo -e "${COL}Cores:${FIN}      " $(sudo cat /sys/devices/system/cpu/cpu*/cpufreq/cpuinfo_cur_freq);
fi
echo -e "${COL}Governor:${FIN}   " $(cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor)
if [[ -f "/proc/meminfo" ]]; then
	MEMTOTAL=$(mem_hwinfo | awk '/MemTotal/ {printf "%.2f", $2; print $3}')
	echo -e "${COL}Memory:${FIN}     " $MEMTOTAL
fi
echo -e "${COL}Entropy:${FIN}    " $(cat /proc/sys/kernel/random/entropy_avail)
echo -e "${COL}Uptime:${FIN}     " $(uptime)
